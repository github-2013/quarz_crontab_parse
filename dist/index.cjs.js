"use strict";const e=24,n=60,s={"1,SUN":{nameCn:"星期天",nameEn:"Sunday"},"2,MON":{nameCn:"星期一",nameEn:"Monday"},"3,TUE":{nameCn:"星期二",nameEn:"Tuesday"},"4,WED":{nameCn:"星期三",nameEn:"Wednesday"},"5,THU":{nameCn:"星期四",nameEn:"Thursday"},"6,FRI":{nameCn:"星期五",nameEn:"Friday"},"7,SAT":{nameCn:"星期六",nameEn:"Saturday"}};function i(e){const n=parseInt(e);if(n<0||n>7)throw new Error("crontab表达式有误，dayOfWeek数字应为1-7");return function(e,n=!0){const i=Object.entries(s);for(let s=0;s<i.length;s++){const[t,l]=i[s];if(t.includes(e))return n?l.nameCn:l.nameEn}}(e)}function t(e,n,s,i){let t="";const l=e.split("/"),$=l[0],c=l[1],f=`${n+parseInt($)-parseInt(c)}`,u=i[s];let o=i[s];return 1==s?o="分钟":2==s&&(o="小时"),t+=`从${$}${u}开始到${f}${u}范围内,每隔${c}${o}`,t}module.exports=function(s){return function(s,l){if(null===s||s.trim().length<1)throw new Error("cron表达式为空");const $=s.trim().split(" ");let c="";if(6===$.length||7===$.length){if(7===$.length){const e=$[6];if("*"!==e&&"?"!==e)if(e.includes("-")){const n=e.split("-");c+=`${n[0]}年到${n[1]}年`}else c+=`${e}${l[6]}`}const s=$[4];if("*"!==s&&"?"!==s)if(s.includes("/"))c+=`从${s.split("/")[0]}号开始",每${s.split("/")[1]}${l[4]}`;else{c.includes("-")&&(c+="每年");const e=s.split("-");c+=`${e[0]}月到${e[1]}月`}let f=$[5];if("*"!==f&&"?"!==f)if(f.includes(","))c+=`每周的第${f}${l[3]}`;else if(f.includes("L")&&f.length>1){c+="每月的最后一周的",c+=i(f.split("L")[0])}else if(f.includes("-")){const e=f.split("-");c+=`每周的${i(e[0])}到${i(e[1])}`}else{"L"===f&&(f="7"),c+="每周的";c+=i(f)}const u=$[3];if("?"!==u&&"*"!==u)if(u.includes("/"))c+=`每周从第${u.split("/")[0]}天开始,每${u.split("/")[1]}${l[3]}`;else if("L"===u)c+="每月最后一天";else if("W"===u)c+=u;else if(u.includes("#")){const e=u.split("#"),n=e[0],s=e[1],t=i(n);c+=`每月第${s}${l[5]}${t}`}else c+=`每月${u}号`;else 0!==c.length&&7!==$.length||c.includes("星期")||"?"!==u&&(c+=`每${l[3]}`);const o=$[2];if("*"!==o)if("?"===o);else if(o.includes("/"))c+=t(o,e,2,l);else if("0"!==o)if(o.includes("-")){const e=o.split("-"),n=e[0],s=e[1];c+=`${n}${l[2]}到${s}${l[2]}`}else c+=`每天${o}${l[2]}`;else c+=`${o}${l[2]}`;const r=$[1];if("*"!==r)if("?"===r);else if(r.includes("/"))c+=t(r,n,1,l);else if(r.includes("-")){const e=r.split("-");c+=`${e[0]}${l[1]}到${e[1]}${l[1]}每分钟`}else r.includes(",")?c+=`第${r}${l[1]}`:c+=`${r}${l[1]}`;const a=$[0];if("*"!==a)if(a.includes("/"))c+=t(a,n,0,l);else if("0"!==a)if(a.includes("-")){const e=a.split("-"),n=e[0],s=e[1];c+=`${n}${l[0]}到${s}${l[0]}`}else a.includes(",")?c+=`第${a}${l[0]}`:c+=`每${a}${l[0]}`;else 0===c.length&&(c+=`每${a}${l[0]}`);0===c.length&&(c="表达式转换异常")}return c}(s,["秒","分","时","天","月","周","年"])};
