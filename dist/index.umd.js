!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).parseCrontab=n()}(this,(function(){"use strict";const e={1:{nameCn:"星期天",nameEn:"Sunday"},2:{nameCn:"星期一",nameEn:"Monday"},3:{nameCn:"星期二",nameEn:"Tuesday"},4:{nameCn:"星期三",nameEn:"Wednesday"},5:{nameCn:"星期四",nameEn:"Thursday"},6:{nameCn:"星期五",nameEn:"Friday"},7:{nameCn:"星期六",nameEn:"Saturday"}},n={"秒":/^([0-5]?[0-9])$/,"分":/^([0-5]?[0-9])$/,"时":/^([01]?[0-9]|2[0-3])$/,"日":/^(3[01]|[12][0-9]|[1-9])$/,"月":/^(1[0-2]|[1-9])$/,"周":/^([1-7])$/,"年":/^((19|20)\d{2})$/},t={"秒":/^([0-5]?[0-9])#(\d+)$/,"分":/^([0-5]?[0-9])#(\d+)$/,"时":/^([01]?[0-9]|2[0-3])#(\d+)$/,"日":/^(3[01]|[12][0-9]|[1-9])#(\d+)$/,"月":/^(1[0-2]|[1-9])#(\d+)$/,"周":/^([1-7])#(\d+)$/,"年":/^((19|20)\d{2})#(\d+)$/},r={"秒":{range:60,unit:"秒"},"分":{range:60,unit:"分钟"},"时":{range:24,unit:"小时"}};function s(e,s,c){switch(!0){case/^\*$/.test(e):return`每${s}`;case/^\?$/.test(e):return"";case/^\d+#\d+$/.test(e):{const n=e.match(t[s]);if(n)return function(e,n){switch(n){case"秒":case"分":case"时":case"日":case"月":return`第${e[2]}个${e[1]}${n}`;case"周":return`第${e[2]}个${a(e[1])}`;case"年":return`第${e[3]}个${e[1]}${n}`;default:return""}}(n,s);throw new Error(`${s}${e}格式不正确`)}case/^(\d+,)+\d+$/.test(e):return function(e,n){function t(e){if(2===e.split(",").length)return`第${e.replace(/,/g,"和第")}${n}`;{const t=e.lastIndexOf(","),r=e.substring(t+1);return`第${e.substring(0,t).replace(/,/g,"、第")}和第${r}${n}`}}switch(n){case"秒":case"时":case"日":case"月":case"周":case"年":return t(e);case"分":return`${t(e)}钟`;default:return""}}(e,s);case/^[0-9]+-[0-9]+$/.test(e):return function(e,n){const t=e.split("-"),[r,s]=t;switch(n){case"秒":case"分":case"时":case"日":case"月":case"年":return`${r}${n}到${s}${n}`;case"周":return`${n}${a(r)}到${a(s)}`;default:return""}}(e,s);case/^[*0-9]+\/[0-9]+$/.test(e):if(["时","分","秒"].includes(s))return function(e,n){const t=e.split("/"),[s,a]=t,c=r[n].range+parseInt("*"===s?"0":s)-parseInt(a);return`,从${"*"===s?"0":s}${n}开始到${c}${r[n].unit}范围内每隔${a}${r[n].unit}`}(e,s);{const n=e.split("/"),[t,r]=n;return["0","*"].includes(t)?`每隔${r}${s}`:`从第${t}${s}开始，每隔${r}${s}`}case/^\d*[Ll]$/.test(e):{const n=e.split("L"),[t]=n;return a(n[0])?`最后一${s}的${a(t)}`:`最后一${s}`}case/^\d+$/.test(e):if(e.match(n[s]))return function(e,n){switch(n){case"秒":case"分":case"时":case"日":case"月":case"年":return`${e}${n}`;case"周":return`每周${a(e)}`;default:return""}}(e,s);throw new Error(`${s}${e}格式不正确`);default:return""}}function a(n,t=!0){const r=Object.entries(e);for(let e=0;e<r.length;e++){const[s,a]=r[e];if(s===n)return t?a.nameCn:a.nameEn}}function c(e,n){return`${e}-${n}`}return function(e){return function(e,n){if(null===e||e.trim().length<1)throw new Error("cron表达式为空");let t=e.trim().split(" "),r="";if(6===t.length||7===t.length){if(t.every((e=>"*"===e)))return"每秒";if(7===t.length){r=s(t[6],n[6])}r=c(r,s(t[5],n[5]));r=c(r,s(t[4],n[4]));r=c(r,s(t[3],n[3]));r=c(r,s(t[2],n[2]));r=c(r,s(t[1],n[1]));return r=c(r,s(t[0],n[0])),r=function(e,n){let t=e.split("-");if(""!==t[2]&&""!==t[1]){let e=t[2];return t[2]=t[1],t[1]=e,t.reverse().slice(0,n.length).reverse().join("")}let r=n.findIndex((e=>"*"===e)),s=0;for(let e=r;e<t.length;e++)t[e]&&""!==t[e]&&(s+=1);return r>=0&&0===s?t.reverse().slice(0,n.length).slice(0,r+1).reverse().join(""):t.filter((e=>e.length)).join("")}(r,t),r.length?/^[每最第从\d]/.test(r)?r:/^[,]/.test(r)?r.substring(1):`每${r}`:r}throw new Error("crontab格式不正确")}(e,["秒","分","时","日","月","周","年"])}}));
